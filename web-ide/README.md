# 骆言在线IDE

一个专为骆言编程语言设计的功能强大的Web IDE，支持查看和编辑所有测试代码和示例程序。

## 🚀 功能特性

### 📁 智能文件管理
- **自动文件扫描**: 智能识别项目中的402个文件（198个.ly文件，69个.ml测试文件等）
- **分类浏览**: 按功能分类组织文件：示例程序、测试文件、标准库、自举编译器等
- **实时搜索**: 快速定位目标文件和代码片段
- **文件预览**: 显示文件大小、修改时间等元数据

### 💻 专业编程环境
- **语法高亮**: 专门为骆言语言优化的语法着色系统
- **代码折叠**: 支持函数、代码块的智能折叠
- **括号匹配**: 自动匹配中英文括号和引号
- **智能缩进**: 自动缩进和代码格式化
- **多标签编辑**: 同时打开多个文件进行编辑

### 🎨 用户体验
- **双主题切换**: 深色/浅色主题自由切换
- **响应式设计**: 完美支持桌面和移动设备
- **全屏模式**: 专注编程的沉浸式体验
- **键盘快捷键**: 高效的编程快捷键支持

### 🔧 开发工具
- **代码执行模拟**: 模拟骆言和OCaml代码的运行效果
- **C代码编译**: 将骆言代码编译为标准C语言代码
- **WebAssembly编译**: 支持编译到WebAssembly模块
- **输出面板**: 实时显示程序输出和错误信息
- **文件下载**: 支持编辑后的代码文件下载
- **项目统计**: 实时显示项目文件和代码统计信息

## 📊 项目统计

- **总文件数**: 402个
- **骆言源码**: 198个 .ly 文件
- **测试文件**: 69个 .ml 文件
- **输出样例**: 26个 .expected/.expected_error 文件
- **项目大小**: 约1.5MB

## 🗂️ 文件分类

### 示例程序 (72个)
包含各种骆言语言特性的演示代码：
- 基础语法和数据类型
- 函数定义和递归
- 模式匹配和条件控制
- 数组和列表操作
- 算法实现（排序、搜索等）

### 测试文件 (190个)
全面的测试套件：
- 语法解析测试
- 语义分析测试
- 代码生成测试
- 错误处理测试
- 性能基准测试

### 标准库 (10个)
核心库实现：
- 基础.ly - 基本数据类型和操作
- 列表.ly - 列表操作函数
- 字符串.ly - 字符串处理
- 数学.ly - 数学计算函数
- 输入输出.ly - IO操作

### 其他组件
- **自举编译器** (22个): 用骆言语言实现的编译器
- **性能测试** (20个): 微基准和宏基准测试
- **VSCode扩展** (2个): 编辑器支持文件

## 🛠️ 技术实现

### 前端技术栈
- **HTML5 + CSS3**: 现代Web标准
- **原生JavaScript**: 无依赖的纯JS实现
- **CodeMirror**: 专业的代码编辑器组件
- **Font Awesome**: 图标字体库

### 核心组件

#### 1. 文件清单生成器 (`generate-manifest.js`)
```javascript
// 自动扫描项目文件，生成可在浏览器中使用的文件清单
// 支持多种文件类型，智能分类，实时统计
```

#### 2. 骆言语法高亮 (`luoyan-mode.js`)
```javascript
// 专门为骆言语言定制的CodeMirror语法模式
// 支持中文关键字、引用标识符、古雅体语法
```

#### 3. 主应用 (`app.js`)
```javascript
// 核心IDE功能实现：文件管理、编辑器、UI交互
// 420行代码实现完整的Web IDE体验
```

### 语言特性支持

#### 骆言语法高亮
- **中文关键字**: `设`、`为`、`夫`、`者`、`受`、`焉`、`算法`、`乃`等
- **引用标识符**: `「变量名」` 语法
- **字符串语法**: `『字符串内容』`
- **注释语法**: `「：注释内容：」`
- **操作符**: 支持中英文操作符混合使用

#### 智能编辑
- **自动补全**: 基于语法结构的智能提示
- **错误检测**: 实时语法错误标注
- **代码折叠**: 函数和代码块的层次化折叠
- **括号匹配**: 中英文括号的智能配对

## 🚀 使用指南

### 快速开始
1. 在浏览器中打开 `index.html`
2. 左侧文件浏览器选择感兴趣的文件
3. 开始浏览和编辑骆言代码
4. 使用工具栏功能增强开发体验

### 键盘快捷键
- `Ctrl+S`: 保存当前文件
- `Ctrl+R`: 运行当前代码
- `Ctrl+F`: 搜索代码
- `Ctrl+H`: 查找替换
- `F11`: 切换全屏模式

### 文件操作
- **打开文件**: 点击左侧文件浏览器中的文件名
- **切换文件**: 使用顶部标签栏
- **关闭文件**: 点击标签上的 ❌ 按钮
- **搜索文件**: 使用顶部搜索框快速定位

### 主题和界面
- **主题切换**: 点击工具栏的 🌙/☀️ 按钮
- **全屏模式**: 点击 ⛶ 按钮进入专注模式
- **响应式**: 自动适配不同屏幕尺寸

## 🔧 部署说明

### GitHub Pages部署
1. 确保所有文件都在 `web-ide/` 目录下
2. 运行文件清单生成器: `node generate-manifest.js`
3. 提交代码到Git仓库
4. 在GitHub仓库设置中启用Pages
5. 选择部署源为 GitHub Actions
6. 访问 `https://用户名.github.io/仓库名/web-ide/`

### 本地开发
```bash
# 进入web-ide目录
cd web-ide

# 生成文件清单
node generate-manifest.js

# 启动本地服务器（可选）
python -m http.server 8000
# 或
npx serve .

# 在浏览器中打开
open http://localhost:8000
```

### 自动化构建
项目支持通过GitHub Actions自动构建和部署：

```yaml
# .github/workflows/pages.yml
name: 部署骆言在线IDE到Pages
on:
  push:
    branches: [ main ]
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: 生成文件清单
        run: cd web-ide && node generate-manifest.js
      - name: 部署到Pages
        uses: actions/deploy-pages@v2
```

## 🎯 示例代码展示

IDE支持展示和编辑各种骆言代码，例如：

```luoyan
「：斐波那契数列计算示例：」

夫「斐波那契」者受 n 焉算法乃
  观「n」之性
  若 0 则 答 0
  若 1 则 答 1
  余者则 答 斐波那契 得 n 减 1 加 斐波那契 得 n 减 2
  观毕也

设「结果」为斐波那契 10
打印 结果
```

```luoyan
「：快速排序算法实现：」

夫「快速排序」者受 列表 焉算法乃
  观「列表」之性
  若 空 则 答 空列表
  余者则
    设「头」为列表之首
    设「尾」为列表之尾
    设「小者」为筛选 尾 小于 头
    设「大者」为筛选 尾 大于等于 头
    答 连接 快速排序小者 头 快速排序大者
  观毕也
```

## 🚀 编译功能

### C语言编译
- **实时编译**: 将骆言代码编译为标准C语言代码
- **语法支持**: 支持变量声明、函数定义、打印语句等基本语法
- **运行时支持**: 自动生成必要的运行时函数
- **文件下载**: 编译后的C代码可直接下载

### WebAssembly编译  
- **双步编译**: 先编译为C代码，再编译为WebAssembly
- **模块生成**: 生成可在浏览器中执行的WebAssembly模块
- **性能优化**: 支持高性能的Web应用开发
- **跨平台**: 生成的模块可在任何支持WebAssembly的环境中运行

### 使用方式
1. 打开任意 `.ly` 文件
2. 点击 **编译到C** 按钮生成C代码
3. 点击 **编译到WASM** 按钮生成WebAssembly模块
4. 查看编译输出并下载生成的文件

## 🔮 未来规划

- [ ] **代码智能补全**: 基于AST的智能提示
- [ ] **实时错误检查**: 语法和类型错误实时标注
- [ ] **代码格式化**: 自动格式化骆言代码
- [ ] **调试支持**: 断点、单步执行等调试功能
- [ ] **版本控制**: Git集成，差异对比
- [ ] **协作编辑**: 多人实时协作开发
- [ ] **插件系统**: 可扩展的插件架构
- [ ] **移动端优化**: 更好的移动设备支持
- [ ] **更完整的编译器**: 与后端OCaml编译器完全兼容
- [ ] **LLVM后端**: 支持更多目标平台的编译

## 📝 许可证

本项目遵循与主项目相同的开源许可证。

## 🤝 贡献指南

欢迎提交问题报告、功能请求和代码贡献：

1. Fork本仓库
2. 创建功能分支: `git checkout -b feature/amazing-feature`
3. 提交更改: `git commit -m 'Add amazing feature'`
4. 推送分支: `git push origin feature/amazing-feature`
5. 创建Pull Request

---

**骆言在线IDE** - 让中文编程更加便捷和优雅 🚀