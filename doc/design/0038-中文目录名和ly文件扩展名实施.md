# 中文目录名和.ly文件扩展名实施计划

## 概述

根据 GitHub Issue #34 的要求，我们需要将所有目录名改为中文，并将文件扩展名从 `.luoyan` 改为 `.ly`。这是一个重大的breaking change，需要谨慎实施。

## 目标

1. **目录名中文化**：将所有英文目录名改为对应的中文名称
2. **文件扩展名统一**：将 `.luoyan` 扩展名改为 `.ly`
3. **标准库名称中文化**：确保标准库目录和模块名称使用中文

## 影响分析

### 目录重命名计划

| 当前英文名 | 建议中文名 | 说明 |
|-----------|-----------|------|
| `src/` | `源码/` | 编译器源代码 |
| `test/` | `测试/` | 测试文件 |
| `examples/` | `示例/` | 示例程序 |
| `benchmarks/` | `性能测试/` | 性能基准测试 |
| `bin/` | `可执行文件/` | 可执行程序 |
| `bootstrap/` | `自举/` | 自举编译器 |
| `c_backend/` | `C后端/` | C语言后端 |
| `debug/` | `调试/` | 调试工具 |
| `doc/` | `文档/` | 保持不变（已是中文） |
| `stdlib/` | `标准库/` | 保持不变（已是中文） |
| `temp/` | `临时/` | 临时文件 |

### 文件扩展名变更

- **变更范围**：所有 `.luoyan` 文件改为 `.ly`
- **影响文件数**：约50-100个文件
- **涉及路径**：
  - `examples/*.luoyan` → `examples/*.ly`
  - `bootstrap/**/*.luoyan` → `bootstrap/**/*.ly`
  - `stdlib/*.luoyan` → `stdlib/*.ly`
  - `test/**/*.luoyan` → `test/**/*.ly`

## 实施策略

### 阶段1：设计和规划
- [x] 创建设计文档
- [ ] 创建RFC issue征求意见
- [ ] 制定详细的迁移计划

### 阶段2：代码准备
- [ ] 更新编译器代码中的文件扩展名处理逻辑
- [ ] 更新构建脚本和工具链
- [ ] 更新测试脚本

### 阶段3：文件重命名
- [ ] 批量重命名文件扩展名
- [ ] 重命名目录结构
- [ ] 更新所有引用路径

### 阶段4：验证和修复
- [ ] 运行完整测试套件
- [ ] 修复所有路径相关错误
- [ ] 更新文档和README

## 技术考虑

### 编译器代码修改
需要修改以下文件中的扩展名处理：
- `src/compiler.ml` - 文件输入处理
- `src/main.ml` - 命令行参数处理
- 测试脚本 - 文件发现逻辑

### 构建系统修改
- `dune-project` 和 `dune` 文件可能需要更新
- 构建脚本需要更新文件模式匹配

### 版本控制
- 使用 `git mv` 保持文件历史
- 分批次提交减少冲突风险

## 风险和缓解

### 主要风险
1. **破坏现有工作流**：用户的现有 `.luoyan` 文件需要重命名
2. **CI/CD 流水线失败**：构建脚本可能因路径变更而失败
3. **文档过时**：大量文档中的路径引用需要更新

### 缓解策略
1. **向后兼容期**：编译器短期内同时支持两种扩展名
2. **自动迁移工具**：提供脚本帮助用户迁移现有项目
3. **详细发布说明**：明确说明breaking change和迁移指南

## 实施时间表

- **第1周**：设计规划和RFC讨论
- **第2周**：代码准备和工具更新
- **第3周**：文件重命名和路径更新
- **第4周**：测试验证和文档更新

## 成功标准

1. ✅ 所有目录名使用中文
2. ✅ 所有源码文件使用 `.ly` 扩展名
3. ✅ 全部测试通过
4. ✅ 文档和示例更新完成
5. ✅ CI/CD 流水线正常运行

## 后续跟进

- 监控社区反馈
- 提供迁移支持
- 必要时制作迁移工具

---

**状态**：设计阶段  
**负责人**：Claude Agent  
**相关Issue**：#34  
**预计完成时间**：4周内