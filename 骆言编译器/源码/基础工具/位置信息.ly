(乘
*
*
*

「:位置信息类型:」
类型 位置等于「
  文件名: 字符串;
  行号: 整数;
  列号: 整数;
  偏移量: 整数;
」

「:位置范围类型:」
类型 位置范围等于「
  开始位置: 位置;
  结束位置: 位置;
」

「:创建初始位置:」
夫「创建初始位置」者受 文件名 焉算法乃 「
  文件名等于文件名;
  行号等于1;
  列号等于1;
  偏移量等于0;
」 也

「:前进一个字符的位置:」
夫「前进位置」者受 位置 字符 焉算法乃
  观「字符」之性
  或 『\数『 减大于 「
      文件名等于位置点文件名;
      行号等于位置点行号 加 1;
      列号等于1;
      偏移量等于位置点偏移量 加 1;
    」
  或 下划线 减大于 「
      文件名等于位置点文件名;
      行号等于位置点行号;
      列号等于位置点列号 加 1;
      偏移量等于位置点偏移量 加 1;
    」
  观毕
也

「:创建位置范围:」
夫「创建位置范围」者受 开始 结束 焉算法乃 「
  开始位置等于开始;
  结束位置等于结束;
」 也

「:格式化位置信息:」
夫「格式化位置」者受 位置 焉算法乃
  位置点文件名 乘方 『:』 乘方
  (整数转字符串 位置点行号) 乘方 『:』 乘方
  (整数转字符串 位置点列号)
也

「:格式化位置范围:」
夫「格式化位置范围」者受 范围 焉算法乃
  如果 范围点开始位置点文件名等于范围点结束位置点文件名 那么
    如果 范围点开始位置点行号等于范围点结束位置点行号 那么
      「:同一行:」
      范围点开始位置点文件名 乘方 『:』 乘方
      (整数转字符串 范围点开始位置点行号) 乘方 『:』 乘方
      (整数转字符串 范围点开始位置点列号) 乘方 『减』 乘方
      (整数转字符串 范围点结束位置点列号)
    否则
      「:多行:」
      范围点开始位置点文件名 乘方 『:』 乘方
      (整数转字符串 范围点开始位置点行号) 乘方 『:』 乘方
      (整数转字符串 范围点开始位置点列号) 乘方 『减』 乘方
      (整数转字符串 范围点结束位置点行号) 乘方 『:』 乘方
      (整数转字符串 范围点结束位置点列号)
  否则
    「:不同文件:」
    (格式化位置 范围点开始位置) 乘方 『 到 』 乘方 (格式化位置 范围点结束位置)
也

「:比较位置:」
夫「位置比较」者受 位置1 位置2 焉算法乃
  设「文件比较」为字符串比较 位置1点文件名 位置2点文件名 在
  如果 文件比较 !等于0 那么 文件比较
  否则
    设「行比较」为整数比较 位置1点行号 位置2点行号 在
    如果 行比较 !等于0 那么 行比较
    否则 整数比较 位置1点列号 位置2点列号
也

「:检查位置是否在范围内:」
夫「位置在范围内」者受 位置 范围 焉算法乃
  (位置比较 范围点开始位置 位置) 小于等于0 和和
  (位置比较 位置 范围点结束位置) 小于等于0
也

「:合并两个位置范围:」
夫「合并位置范围」者受 范围1 范围2 焉算法乃
  设「开始」为如果 (位置比较 范围1点开始位置 范围2点开始位置) 小于等于0
            那么 范围1点开始位置
            否则 范围2点开始位置 在
  设「结束」为如果 (位置比较 范围1点结束位置 范围2点结束位置) 大于等于0
            那么 范围1点结束位置
            否则 范围2点结束位置 在
  创建位置范围 开始 结束
也

「:扩展位置范围:」
夫「扩展位置范围」者受 范围 位置 焉算法乃
  设「开始」为如果 (位置比较 范围点开始位置 位置) 小于等于0
            那么 范围点开始位置
            否则 位置 在
  设「结束」为如果 (位置比较 范围点结束位置 位置) 大于等于0
            那么 范围点结束位置
            否则 位置 在
  创建位置范围 开始 结束
也
