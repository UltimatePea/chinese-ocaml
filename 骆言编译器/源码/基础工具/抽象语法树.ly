（*
 * 抽象语法树 （AST） 定义
 * 定义骆言编程语言的语法结构
 *）

「：引入位置信息：」
使用 位置信息

「：字面量类型：」
类型 字面量=  | 整数字面量 的 整数
  | 浮点字面量 的 浮点数
  | 字符串字面量 的 字符串
  | 布尔字面量 的 布尔值
  | 单元字面量

「：二元运算符：」
类型 二元运算符=  | 加法 | 减法 | 乘法 | 除法 | 模运算
  | 等于 | 不等于 | 小于 | 小于等于 | 大于 | 大于等于
  | 逻辑与 | 逻辑或
  | 字符串连接

「：一元运算符：」
类型 一元运算符=  | 逻辑非
  | 数值取反

「：模式类型：」
类型 模式=  | 字面量模式 的 字面量 乘 位置范围
  | 变量模式 的 字符串 乘 位置范围
  | 通配符模式 的 位置范围
  | 空列表模式 的 位置范围
  | 列表头尾模式 的 模式 乘 模式 乘 位置范围
  | 元组模式 的 模式 列表 乘 位置范围
  | 记录模式 的 （字符串 乘 模式） 列表 乘 位置范围
  | 构造器模式 的 字符串 乘 模式 列表 乘 位置范围
  | 或模式 的 模式 乘 模式 乘 位置范围
  | 条件模式 的 模式 乘 表达式 乘 位置范围

「：表达式类型：」
和 表达式=  | 字面量表达式 的 字面量 乘 位置范围
  | 变量表达式 的 字符串 乘 位置范围
  | 二元运算表达式 的 表达式 乘 二元运算符 乘 表达式 乘 位置范围
  | 一元运算表达式 的 一元运算符 乘 表达式 乘 位置范围
  | 条件表达式 的 表达式 乘 表达式 乘 表达式 乘 位置范围
  | 让绑定表达式 的 字符串 乘 表达式 乘 表达式 乘 位置范围
  | 函数表达式 的 字符串 列表 乘 表达式 乘 位置范围
  | 函数调用表达式 的 表达式 乘 表达式 列表 乘 位置范围
  | 模式匹配表达式 的 表达式 乘 （模式 乘 表达式） 列表 乘 位置范围
  | 列表表达式 的 表达式 列表 乘 位置范围
  | 元组表达式 的 表达式 列表 乘 位置范围
  | 记录表达式 的 （字符串 乘 表达式） 列表 乘 位置范围
  | 字段访问表达式 的 表达式 乘 字符串 乘 位置范围
  | 记录更新表达式 的 表达式 乘 （字符串 乘 表达式） 列表 乘 位置范围
  | 数组表达式 的 表达式 列表 乘 位置范围
  | 数组访问表达式 的 表达式 乘 表达式 乘 位置范围
  | 数组更新表达式 的 表达式 乘 表达式 乘 表达式 乘 位置范围
  | 引用表达式 的 表达式 乘 位置范围
  | 解引用表达式 的 表达式 乘 位置范围
  | 赋值表达式 的 表达式 乘 表达式 乘 位置范围
  | 构造器表达式 的 字符串 乘 表达式 列表 乘 位置范围
  | 序列表达式 的 表达式 列表 乘 位置范围
  | 异常抛出表达式 的 表达式 乘 位置范围
  | 异常捕获表达式 的 表达式 乘 （模式 乘 表达式） 列表 乘 位置范围

「：类型表达式：」
类型 类型表达式=  | 基础类型 的 字符串 乘 位置范围
  | 类型变量 的 字符串 乘 位置范围
  | 函数类型 的 类型表达式 乘 类型表达式 乘 位置范围
  | 元组类型 的 类型表达式 列表 乘 位置范围
  | 列表类型 的 类型表达式 乘 位置范围
  | 记录类型 的 （字符串 乘 类型表达式） 列表 乘 位置范围
  | 变体类型 的 字符串 乘 类型表达式 列表 乘 位置范围
  | 引用类型 的 类型表达式 乘 位置范围
  | 数组类型 的 类型表达式 乘 位置范围

「：类型定义：」
类型 类型定义=  | 类型别名 的 字符串 乘 类型表达式 乘 位置范围
  | 变体类型定义 的 字符串 乘 （字符串 乘 类型表达式 列表） 列表 乘 位置范围
  | 记录类型定义 的 字符串 乘 （字符串 乘 类型表达式） 列表 乘 位置范围

「：语句类型：」
类型 语句=  | 表达式语句 的 表达式
  | 让绑定语句 的 字符串 乘 表达式 乘 位置范围
  | 递归让绑定语句 的 字符串 乘 表达式 乘 位置范围
  | 类型定义语句 的 类型定义
  | 异常定义语句 的 字符串 乘 类型表达式 选项 乘 位置范围

「：程序类型：」
类型 程序=语句 列表

「：获取表达式的位置范围：」
夫「表达式位置」者受 表达式 焉算法乃
  观「表达式」之性
  | 字面量表达式 （_, 位置） -> 位置
  | 变量表达式 （_, 位置） -> 位置
  | 二元运算表达式 （_, _, _, 位置） -> 位置
  | 一元运算表达式 （_, _, 位置） -> 位置
  | 条件表达式 （_, _, _, 位置） -> 位置
  | 让绑定表达式 （_, _, _, 位置） -> 位置
  | 函数表达式 （_, _, 位置） -> 位置
  | 函数调用表达式 （_, _, 位置） -> 位置
  | 模式匹配表达式 （_, _, 位置） -> 位置
  | 列表表达式 （_, 位置） -> 位置
  | 元组表达式 （_, 位置） -> 位置
  | 记录表达式 （_, 位置） -> 位置
  | 字段访问表达式 （_, _, 位置） -> 位置
  | 记录更新表达式 （_, _, 位置） -> 位置
  | 数组表达式 （_, 位置） -> 位置
  | 数组访问表达式 （_, _, 位置） -> 位置
  | 数组更新表达式 （_, _, _, 位置） -> 位置
  | 引用表达式 （_, 位置） -> 位置
  | 解引用表达式 （_, 位置） -> 位置
  | 赋值表达式 （_, _, 位置） -> 位置
  | 构造器表达式 （_, _, 位置） -> 位置
  | 序列表达式 （_, 位置） -> 位置
  | 异常抛出表达式 （_, 位置） -> 位置
  | 异常捕获表达式 （_, _, 位置） -> 位置

「：获取模式的位置范围：」
夫「模式位置」者受 模式 焉算法乃
  观「模式」之性
  | 字面量模式 （_, 位置） -> 位置
  | 变量模式 （_, 位置） -> 位置
  | 通配符模式 位置 -> 位置
  | 空列表模式 位置 -> 位置
  | 列表头尾模式 （_, _, 位置） -> 位置
  | 元组模式 （_, 位置） -> 位置
  | 记录模式 （_, 位置） -> 位置
  | 构造器模式 （_, _, 位置） -> 位置
  | 或模式 （_, _, 位置） -> 位置
  | 条件模式 （_, _, 位置） -> 位置

「：获取类型表达式的位置范围：」
夫「类型表达式位置」者受 类型表达式 焉算法乃
  观「类型表达式」之性
  | 基础类型 （_, 位置） -> 位置
  | 类型变量 （_, 位置） -> 位置
  | 函数类型 （_, _, 位置） -> 位置
  | 元组类型 （_, 位置） -> 位置
  | 列表类型 （_, 位置） -> 位置
  | 记录类型 （_, 位置） -> 位置
  | 变体类型 （_, _, 位置） -> 位置
  | 引用类型 （_, 位置） -> 位置
  | 数组类型 （_, 位置） -> 位置

「：遍历AST的工具函数：」
夫 递归 遍历表达式 者 受 访问函数 表达式 焉算法乃
  设「结果」为访问函数 表达式 在
  观「表达式」之性
  | 二元运算表达式 （左, _, 右, _） ->
      遍历表达式 访问函数 左;
      遍历表达式 访问函数 右
  | 一元运算表达式 （_, 子表达式, _） ->
      遍历表达式 访问函数 子表达式
  | 条件表达式 （条件, 真分支, 假分支, _） ->
      遍历表达式 访问函数 条件;
      遍历表达式 访问函数 真分支;
      遍历表达式 访问函数 假分支
  | 让绑定表达式 （_, 值表达式, 体表达式, _） ->
      遍历表达式 访问函数 值表达式;
      遍历表达式 访问函数 体表达式
  | 函数表达式 （_, 体表达式, _） ->
      遍历表达式 访问函数 体表达式
  | 函数调用表达式 （函数表达式, 参数列表, _） ->
      遍历表达式 访问函数 函数表达式;
      List.iter （遍历表达式 访问函数） 参数列表
  | 列表表达式 （元素列表, _） ->
      List.iter （遍历表达式 访问函数） 元素列表
  | 元组表达式 （元素列表, _） ->
      List.iter （遍历表达式 访问函数） 元素列表
  | 记录表达式 （字段列表, _） ->
      List.iter （函数 （_, 表达式） -> 遍历表达式 访问函数 表达式） 字段列表
  | _ -> 结果  「：其他情况不需要进一步遍历：」
  观毕
也