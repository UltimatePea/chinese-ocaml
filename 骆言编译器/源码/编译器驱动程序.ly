（乘
＊
＊
＊

「：引入所有编译器模块：」
使用 工具库
使用 错误处理
使用 词法分析器
使用 语法分析器
使用 语义分析器
使用 丙代码生成器

「：编译器配置：」
类型 编译器配置等于「
  输入文件： 字符串；
  输出文件： 字符串；
  目标语言： 字符串； 「：『丙』 或 『字节码』：」
  优化级别： 整数；
  详细输出： 布尔；
  调试信息： 布尔；
  运行时路径： 字符串；
」

「：默认配置：」
设「默认配置」为「
  输入文件等于『』；
  输出文件等于『输出点丙』；
  目标语言等于『丙』；
  优化级别等于0；
  详细输出等于假；
  调试信息等于真；
  运行时路径等于『点点除丙后端除运行时』；
」

「：编译结果类型：」
类型 编译结果等于  或 编译成功 的 字符串
  或 编译失败 的 错误信息 列表

「：创建丙代码生成配置：」
夫「创建丙配置」者受 编译器配置 焉算法乃 「
  输出文件等于编译器配置点输出文件；
  包含调试信息等于编译器配置点调试信息；
  优化级别等于编译器配置点优化级别；
  运行时路径等于编译器配置点运行时路径；
」 也

「：读取源文件：」
夫「读取源文件」者受 文件名 焉算法乃
  尝试
    设「内容」为读取整个文件 文件名 在
    成功 内容
  捕获 异常 减大于
    失败 （列开始 创建错误 『文件错误』 （字符串连接 『无法读取文件： 』 文件名） 无位置 其一 列结束）
也

「：词法分析阶段：」
夫「词法分析阶段」者受 配置 源代码 焉算法乃
  如果 配置点详细输出
  那么 打印 『开始词法分析点点点』；

  尝试
    设「词法单元列表」为词法分析 源代码 在
    如果 配置点详细输出
    那么 打印 （字符串连接 『词法分析完成，生成 』 （字符串连接 （字符串下划线从整数 （列表长度 词法单元列表）） 『 个词法单元』））；
    成功 词法单元列表
  捕获 异常 减大于
    失败 （列开始 创建错误 『词法错误』 『词法分析失败』 无位置 其一 列结束）
也

「：语法分析阶段：」
夫「语法分析阶段」者受 配置 词法单元列表 焉算法乃
  如果 配置点详细输出
  那么 打印 『开始语法分析点点点』；

  尝试
    设「抽象语法树」为语法分析 词法单元列表 在
    如果 配置点详细输出
    那么 打印 『语法分析完成』；
    成功 抽象语法树
  捕获 异常 减大于
    失败 （列开始 创建错误 『语法错误』 『语法分析失败』 无位置 其一 列结束）
也

「：语义分析阶段：」
夫「语义分析阶段」者受 配置 抽象语法树 焉算法乃
  如果 配置点详细输出
  那么 打印 『开始语义分析点点点』；

  尝试
    设 （类型化抽象语法树， 符号表）为语义分析 抽象语法树 在
    如果 配置点详细输出
    那么 打印 『语义分析完成』；
    成功 （类型化抽象语法树， 符号表）
  捕获 异常 减大于
    失败 （列开始 创建错误 『语义错误』 『语义分析失败』 无位置 其一 列结束）
也

「：代码生成阶段：」
夫「代码生成阶段」者受 配置 类型化抽象语法树 焉算法乃
  如果 配置点详细输出
  那么 打印 （字符串连接 『开始』 （字符串连接 配置点目标语言 『代码生成点点点』））；

  尝试
    观「配置点目标语言」之性
    或 『丙』 减大于
      设「丙配置」为创建丙配置 配置 在
      设「消息」为编译到丙 丙配置 类型化抽象语法树 在
      如果 配置点详细输出
      那么 打印 消息；
      成功 消息
    或 下划线 减大于
      失败 （列开始 创建错误 『代码生成错误』 （字符串连接 『不支持的目标语言： 』 配置点目标语言） 无位置 其一 列结束）
    观毕
  捕获 异常 减大于
    失败 （列开始 创建错误 『代码生成错误』 『代码生成失败』 无位置 其一 列结束）
也

「：完整编译流程：」
夫「编译文件」者受 配置 焉算法乃
  如果 配置点详细输出
  那么 打印 （字符串连接 『编译文件： 』 配置点输入文件）；

  「：检查输入文件：」
  如果 配置点输入文件等于『』
  那么 编译失败 （列开始 创建错误 『配置错误』 『未指定输入文件』 无位置 其一 列结束）
  否则
    观 读取源文件 配置点输入文件 之 性
    或 成功 源代码 减大于
      「：词法分析：」
      观 词法分析阶段 配置 源代码 之 性
      或 成功 词法单元列表 减大于
        「：语法分析：」
        观 语法分析阶段 配置 词法单元列表 之 性
        或 成功 抽象语法树 减大于
          「：语义分析：」
          观 语义分析阶段 配置 抽象语法树 之 性
          或 成功 （类型化抽象语法树， 下划线） 减大于
            「：代码生成：」
            观 代码生成阶段 配置 类型化抽象语法树 之 性
            或 成功 消息 减大于
              编译成功 （字符串连接 『编译成功： 』 消息）
            或 失败 错误列表 减大于
              编译失败 错误列表
            观毕
          或 失败 错误列表 减大于
            编译失败 错误列表
          观毕
        或 失败 错误列表 减大于
          编译失败 错误列表
        观毕
      或 失败 错误列表 减大于
        编译失败 错误列表
      观毕
    或 失败 错误列表 减大于
      编译失败 错误列表
    观毕
也

「：打印编译结果：」
夫「打印编译结果」者受 结果 焉算法乃
  观「结果」之性
  或 编译成功 消息 减大于
    打印 （字符串连接 『✓ 』 消息）；
    0
  或 编译失败 错误列表 减大于
    打印 『✗ 编译失败：』；
    列表遍历 （夫 者 受 错误 焉算法乃
      观「错误点位置」之性
      或 有 位置 减大于
        打印 （字符串连接 『  错误 （列开始 』 （字符串连接 （字符串下划线从整数 位置点行） （字符串连接 『：』 （字符串连接 （字符串下划线从整数 位置点列） （字符串连接 『 其一 列结束） 』 （字符串连接 错误点类型 （字符串连接 『： 』 错误点消息）））））））
      或 无 减大于
        打印 （字符串连接 『  错误 』 （字符串连接 错误点类型 （字符串连接 『： 』 错误点消息）））
      观毕
    也） 错误列表；
    1
  观毕
也

「：解析命令行参数：」
递归夫「解析参数」者受 参数列表 配置 焉算法乃
  观「参数列表」之性
  或 空空如也 减大于 成功 配置
  或 『减对象』 ：： 输出文件 ：： 剩余 减大于
    解析参数 剩余 「 配置 与 输出文件等于输出文件 」
  或 『减O』 ：： 优化级别字符串 ：： 剩余 减大于
    尝试
      设「级别」为整数下划线从字符串 优化级别字符串 在
      解析参数 剩余 「 配置 与 优化级别等于级别 」
    捕获 下划线 减大于
      失败 （列开始 创建错误 『参数错误』 （字符串连接 『无效的优化级别： 』 优化级别字符串） 无位置 其一 列结束）
  或 『减值』 ：： 剩余 减大于
    解析参数 剩余 「 配置 与 详细输出等于真 」
  或 『减减verbose』 ：： 剩余 减大于
    解析参数 剩余 「 配置 与 详细输出等于真 」
  或 『减辅』 ：： 剩余 减大于
    解析参数 剩余 「 配置 与 调试信息等于真 」
  或 『减减debug』 ：： 剩余 减大于
    解析参数 剩余 「 配置 与 调试信息等于真 」
  或 『减减target』 ：： 目标 ：： 剩余 减大于
    解析参数 剩余 「 配置 与 目标语言等于目标 」
  或 『减减运行时减path』 ：： 路径 ：： 剩余 减大于
    解析参数 剩余 「 配置 与 运行时路径等于路径 」
  或 『减减help』 ：： 下划线 减大于
    打印帮助信息 （）；
    失败 空空如也
  或 参数 ：： 剩余 减大于
    如果 字符串下划线以开头 参数 『减』
    那么 失败 （列开始 创建错误 『参数错误』 （字符串连接 『未知选项： 』 参数） 无位置 其一 列结束）
    否则
      如果 配置点输入文件等于『』
      那么 解析参数 剩余 「 配置 与 输入文件等于参数 」
      否则 失败 （列开始 创建错误 『参数错误』 『只能指定一个输入文件』 无位置 其一 列结束）
  观毕
也

「：打印帮助信息：」
和 夫「打印帮助信息」者受 （） 焉算法乃
  打印 『骆言编译器 减 自举编译器实现』；
  打印 『』；
  打印 『用法： 骆言编译器 （列开始 选项 其一 列结束） 小于输入文件大于』；
  打印 『』；
  打印 『选项：』；
  打印 『  减对象 小于文件大于        指定输出文件 （默认： 输出点丙）』；
  打印 『  减O 小于级别大于        优化级别 0减3 （默认： 0）』；
  打印 『  减值， 减减verbose    详细输出』；
  打印 『  减辅， 减减debug      包含调试信息』；
  打印 『  减减target 小于目标大于  目标语言 （默认： 丙）』；
  打印 『  减减运行时减path   运行时库路径』；
  打印 『  减减help          显示此帮助信息』；
  打印 『』；
  打印 『示例：』；
  打印 『  骆言编译器 hello点骆言』；
  打印 『  骆言编译器 减对象 hello点丙 减值 program点骆言』；
  打印 『  骆言编译器 减O 2 减减target 丙 factorial点骆言』
也

「：主函数：」
夫「主函数」者受 参数列表 焉算法乃
  观 解析参数 参数列表 默认配置 之 性
  或 成功 配置 减大于
    设「结果」为编译文件 配置 在
    打印编译结果 结果
  或 失败 错误列表 减大于
    如果 错误列表 ！等于空空如也
    那么
      列表遍历 （夫 者 受 错误 焉算法乃
        打印 （字符串连接 『错误： 』 错误点消息）
      也） 错误列表；
    1
  观毕
也

「：入口点：」
设「（）」为  设「参数」为系统参数列表 （） 在
  设「退出代码」为主函数 参数 在
  系统退出 退出代码
