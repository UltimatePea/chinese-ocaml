(* 骆言宏系统示例 *)

(* 定义一些常用的宏 *)

(* 循环宏 *)
宏 循环 (次数: 表达式) (体: 语句) = {
  递归 让 循环辅助 = 函数 n ->
    如果 n <= 0 那么
      ()
    否则
      体; 循环辅助 (n - 1)
  在 循环辅助 次数 中
}

(* 打印列表宏 *)
宏 打印列表 (列表: 表达式) = {
  递归 让 打印辅助 = 函数 lst ->
    匹配 lst 与
    | [] -> ()
    | [head; ...tail] -> 
      打印 head;
      打印辅助 tail
  在 打印辅助 列表 中
}

(* 断言宏 *)
宏 断言 (条件: 表达式) = {
  如果 条件 那么
    ()
  否则
    打印 "断言失败:";
    打印 条件
}

(* 测试宏 *)
让 数字列表 = [1; 2; 3; 4; 5];

(* 使用循环宏 *)
循环 3 {
  打印 "Hello, 骆言!";
  打印 "这是第";
  打印 "次循环";
};

(* 使用打印列表宏 *)
打印 "数字列表:";
打印列表 数字列表;

(* 使用断言宏 *)
断言 (长度 数字列表 == 5);
断言 (阶乘 5 == 120);

(* 复合宏使用 *)
让 结果列表 = 映射 (函数 x -> x * x) 数字列表;
打印 "平方列表:";
打印列表 结果列表;

(* 自定义宏 *)
宏 重复打印 (消息: 表达式) (次数: 表达式) = {
  循环 次数 {
    打印 消息
  }
}

重复打印 "骆言很棒!" 3; 