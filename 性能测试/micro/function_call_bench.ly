(* 函数调用性能基准测试 *)

(* 简单函数调用测试 *)
让 简单函数 = 函数 x -> x + 1

递归 让 简单调用测试 = 函数 n ->
  如果 n <= 0 那么
    0
  否则
    简单函数 n + 简单调用测试 (n - 1)

(* 多参数函数调用测试 *)
让 多参数函数 = 函数 a b c d -> a + b * c - d

递归 让 多参数调用测试 = 函数 n ->
  如果 n <= 0 那么
    0
  否则
    多参数函数 n (n-1) (n-2) (n-3) + 多参数调用测试 (n - 1)

(* 高阶函数调用测试 *)
让 高阶函数 = 函数 f x -> f (f x)

递归 让 高阶调用测试 = 函数 n ->
  如果 n <= 0 那么
    0
  否则
    高阶函数 简单函数 n + 高阶调用测试 (n - 1)

(* 递归深度测试 *)
递归 让 深度递归 = 函数 n acc ->
  如果 n <= 0 那么
    acc
  否则
    深度递归 (n - 1) (acc + n)

(* 尾递归测试 *)
递归 让 尾递归测试 = 函数 n ->
  递归 让 辅助 = 函数 i acc ->
    如果 i <= 0 那么
      acc
    否则
      辅助 (i - 1) (acc + i)
  在
  辅助 n 0

(* 主测试函数 *)
让 运行函数调用测试 = 函数 规模 ->
  打印 "开始函数调用性能测试";
  
  (* 简单函数调用测试 *)
  打印 "执行简单函数调用测试...";
  让 结果1 = 简单调用测试 规模 在
  打印 "简单函数调用完成";
  打印 结果1;
  
  (* 多参数函数调用测试 *)
  打印 "执行多参数函数调用测试...";
  让 结果2 = 多参数调用测试 (规模 / 2) 在
  打印 "多参数函数调用完成";
  打印 结果2;
  
  (* 高阶函数调用测试 *)
  打印 "执行高阶函数调用测试...";
  让 结果3 = 高阶调用测试 (规模 / 3) 在
  打印 "高阶函数调用完成";
  打印 结果3;
  
  (* 深度递归测试 *)
  打印 "执行深度递归测试...";
  让 结果4 = 深度递归 规模 0 在
  打印 "深度递归完成";
  打印 结果4;
  
  (* 尾递归测试 *)
  打印 "执行尾递归测试...";
  让 结果5 = 尾递归测试 规模 在
  打印 "尾递归完成";
  打印 结果5;
  
  结果1 + 结果2 + 结果3 + 结果4 + 结果5

(* 执行基准测试 *)
让 测试规模 = 200  (* 减小测试规模 *)
打印 "=== 函数调用性能基准测试 ===";
让 最终结果 = 运行函数调用测试 测试规模;
打印 "=== 基准测试完成 ===";
打印 最终结果