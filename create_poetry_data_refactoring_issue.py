#!/usr/bin/env python3
"""
åˆ›å»ºè¯—è¯æ•°æ®æ¨¡å—é‡æ„æŠ€æœ¯å€ºåŠ¡æ”¹è¿›issue
"""

import json
import requests
from github_auth import get_installation_token

def create_issue():
    """åˆ›å»ºæŠ€æœ¯å€ºåŠ¡æ”¹è¿›issue"""
    token = get_installation_token()
    
    headers = {
        'Authorization': f'token {token}',
        'Accept': 'application/vnd.github+json'
    }
    
    issue_title = "æŠ€æœ¯å€ºåŠ¡æ”¹è¿›ï¼šè¯—è¯æ•°æ®æ¨¡å—é‡æ„å’Œæ•°æ®å¤–åŒ– Fix #TechDebt-Poetry-Data"
    
    issue_body = """## ğŸ“‹ é—®é¢˜æè¿°

é€šè¿‡ç³»ç»Ÿæ€§æŠ€æœ¯å€ºåŠ¡åˆ†æï¼Œå‘ç°è¯—è¯æ•°æ®æ¨¡å—å­˜åœ¨ä¸¥é‡çš„æŠ€æœ¯å€ºåŠ¡é—®é¢˜ï¼š

### ğŸ”´ **è¶…é•¿æ–‡ä»¶é—®é¢˜**
- `hui_rhyme_data.ml` (339è¡Œ)
- `feng_rhyme_data.ml` (329è¡Œ)  
- `rhyme_data.ml` (312è¡Œ)
- `yue_rhyme_data.ml` (230è¡Œ)
- `yu_rhyme_data.ml` (216è¡Œ)

### ğŸ”´ **ç¡¬ç¼–ç æ•°æ®é—®é¢˜**
- éŸµå¾‹å­—ç¬¦æ•°æ®ç¡¬ç¼–ç åœ¨æºç ä¸­
- ç»´æŠ¤å›°éš¾ï¼Œæ•°æ®æ›´æ–°éœ€é‡æ–°ç¼–è¯‘
- å¯æ‰©å±•æ€§å·®ï¼Œæ— æ³•åŠ¨æ€é…ç½®

## ğŸ¯ **æ”¹è¿›ç›®æ ‡**

### ä¸»è¦ç›®æ ‡
1. **æ•°æ®å¤–åŒ–**ï¼šå°†è¯—è¯éŸµå¾‹æ•°æ®ç§»è‡³JSONé…ç½®æ–‡ä»¶
2. **æ¨¡å—ç®€åŒ–**ï¼šå°†è¶…é•¿æ¨¡å—æ‹†åˆ†ä¸ºåˆç†å¤§å°
3. **ç»Ÿä¸€æ¥å£**ï¼šå»ºç«‹ç»Ÿä¸€çš„æ•°æ®åŠ è½½å’Œè®¿é—®æœºåˆ¶
4. **æ€§èƒ½ä¼˜åŒ–**ï¼šå®ç°é«˜æ•ˆçš„æ•°æ®ç¼“å­˜ç­–ç•¥

### æŠ€æœ¯è§„æ ¼
- æ•°æ®æ–‡ä»¶è¿ç§»åˆ° `data/poetry/` ç›®å½•
- å®ç°ç»Ÿä¸€çš„JSONæ•°æ®åŠ è½½å™¨
- ä¿æŒå‘åå…¼å®¹çš„APIæ¥å£
- ä¼˜åŒ–å†…å­˜ä½¿ç”¨å’Œè®¿é—®æ€§èƒ½

## ğŸš€ **å®æ–½è®¡åˆ’**

### ç¬¬ä¸€é˜¶æ®µï¼šæ•°æ®å¤–åŒ–é‡æ„
- [ ] åˆ›å»ºJSONæ•°æ®æ–‡ä»¶ç»“æ„
- [ ] å®ç°ç»Ÿä¸€æ•°æ®åŠ è½½å™¨æ¨¡å—
- [ ] è¿ç§»ç°éŸµç»„æ•°æ®ï¼ˆæœ€å¤§æ–‡ä»¶ä¼˜å…ˆï¼‰

### ç¬¬äºŒé˜¶æ®µï¼šæ¨¡å—ç®€åŒ–
- [ ] é‡æ„æ•°æ®è®¿é—®æ¥å£
- [ ] ç®€åŒ–å„éŸµç»„æ¨¡å—ä»£ç 
- [ ] å®ç°ç¼“å­˜æœºåˆ¶

### ç¬¬ä¸‰é˜¶æ®µï¼šæµ‹è¯•å’Œä¼˜åŒ–
- [ ] å®Œå–„å•å…ƒæµ‹è¯•è¦†ç›–
- [ ] æ€§èƒ½åŸºå‡†æµ‹è¯•
- [ ] æ–‡æ¡£æ›´æ–°

## ğŸ† **é¢„æœŸæ”¶ç›Š**

- **å¯ç»´æŠ¤æ€§æå‡**ï¼šæ•°æ®ä¿®æ”¹æ— éœ€é‡æ–°ç¼–è¯‘
- **æ‰©å±•æ€§å¢å¼º**ï¼šä¾¿äºæ·»åŠ æ–°éŸµç»„æ•°æ®
- **æ€§èƒ½ä¼˜åŒ–**ï¼šå‡å°‘å†…å­˜å ç”¨å’Œå¯åŠ¨æ—¶é—´
- **å¼€å‘æ•ˆç‡**ï¼šæ•°æ®ä¸ä»£ç åˆ†ç¦»ï¼ŒèŒè´£æ¸…æ™°

## ğŸ“Š **æŠ€æœ¯å€ºåŠ¡ä¼˜å…ˆçº§**

**ä¼˜å…ˆçº§**ï¼šğŸ”´ é«˜ä¼˜å…ˆçº§  
**å½±å“èŒƒå›´**ï¼šè¯—è¯ç¼–ç¨‹æ ¸å¿ƒåŠŸèƒ½  
**å®æ–½å‘¨æœŸ**ï¼š1-2å‘¨  
**é£é™©è¯„ä¼°**ï¼šä½é£é™©ï¼ˆå‘åå…¼å®¹ï¼‰

---

**é—®é¢˜ç±»å‹**ï¼šæŠ€æœ¯å€ºåŠ¡æ”¹è¿›  
**æ¨¡å—åˆ†ç±»**ï¼šè¯—è¯æ•°æ®ç®¡ç†  
**åˆ›å»ºæ—¶é—´**ï¼š2025-07-20

ğŸ¤– æ­¤issueç”±AIæŠ€æœ¯å€ºåŠ¡åˆ†æç³»ç»Ÿè‡ªåŠ¨åˆ›å»º
"""
    
    url = 'https://api.github.com/repos/UltimatePea/chinese-ocaml/issues'
    
    data = {
        'title': issue_title,
        'body': issue_body,
        'labels': ['æŠ€æœ¯å€ºåŠ¡', 'é‡æ„', 'è¯—è¯åŠŸèƒ½', 'enhancement']
    }
    
    response = requests.post(url, headers=headers, json=data)
    
    if response.status_code == 201:
        issue_data = response.json()
        print(f"âœ… Issueåˆ›å»ºæˆåŠŸï¼")
        print(f"Issueç¼–å·: #{issue_data['number']}")
        print(f"Issue URL: {issue_data['html_url']}")
        return issue_data['number']
    else:
        print(f"âŒ Issueåˆ›å»ºå¤±è´¥:")
        print(f"çŠ¶æ€ç : {response.status_code}")
        print(f"å“åº”: {response.text}")
        return None

if __name__ == '__main__':
    create_issue()